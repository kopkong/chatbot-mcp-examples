# æ™ºèƒ½èŠå¤©æœºå™¨äºº React â†’ Next.js è¿ç§»æŒ‡å—

## è¿ç§»æ¦‚è¿°

æœ¬æ–‡æ¡£è®°å½•äº†å°†æ™ºèƒ½èŠå¤©æœºå™¨äººä» React SPA æ¶æ„æˆåŠŸè¿ç§»åˆ° Next.js 14 App Router æ¶æ„çš„å®Œæ•´è¿‡ç¨‹ã€‚

## ğŸ¯ è¿ç§»ç›®æ ‡

- âœ… ä¿æŒæ‰€æœ‰åŸæœ‰åŠŸèƒ½
- âœ… æå‡å¼€å‘ä½“éªŒå’Œæ€§èƒ½
- âœ… æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ (SSR)
- âœ… ç°ä»£åŒ–æ„å»ºå·¥å…·é“¾
- âœ… å®¹å™¨åŒ–éƒ¨ç½²æ”¯æŒ

## ğŸ“‹ å·²å®ŒæˆåŠŸèƒ½

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **å¤šLLMæ”¯æŒ**: OpenAIã€DeepSeekã€Ollamaç­‰
- âœ… **MCPé›†æˆ**: Model Context Protocolå·¥å…·æ”¯æŒ
- âœ… **Promptå·¥ç¨‹**: è‡ªå®šä¹‰ç³»ç»Ÿæç¤ºè¯å’Œé¢„è®¾æ¨¡æ¿
- âœ… **é…ç½®ç®¡ç†**: å®Œæ•´çš„è®¾ç½®é¢æ¿å’Œæœ¬åœ°å­˜å‚¨
- âœ… **èŠå¤©ç•Œé¢**: å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒMarkdownæ¸²æŸ“
- âœ… **æ¶ˆæ¯ç®¡ç†**: æ¸…ç©ºã€å¯¼å‡ºã€å†å²è®°å½•
- âœ… **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯è¾¹ç•Œå’Œé€šçŸ¥ç³»ç»Ÿ

### æŠ€æœ¯ç‰¹æ€§
- âœ… **Next.js 14**: æœ€æ–°ç‰ˆæœ¬æ”¯æŒ
- âœ… **App Router**: æ–°ä¸€ä»£è·¯ç”±ç³»ç»Ÿ
- âœ… **TypeScript**: å®Œæ•´ç±»å‹æ”¯æŒ
- âœ… **é”™è¯¯è¾¹ç•Œ**: Reacté”™è¯¯æ•è·ç»„ä»¶
- âœ… **ç¯å¢ƒå˜é‡**: é…ç½®ç®¡ç†ä¼˜åŒ–
- âœ… **Dockeræ”¯æŒ**: ç”Ÿäº§éƒ¨ç½²å®¹å™¨åŒ–
- âœ… **çƒ­é‡è½½**: ä¼˜åŒ–çš„å¼€å‘ä½“éªŒ

### UI/UXæ”¹è¿›
- âœ… **ç°ä»£åŒ–è®¾è®¡**: ä¿æŒåŸæœ‰è§†è§‰é£æ ¼
- âœ… **æ·±è‰²ä¸»é¢˜**: è‡ªåŠ¨æ£€æµ‹å’Œåˆ‡æ¢
- âœ… **å“åº”å¼å¸ƒå±€**: ç§»åŠ¨ç«¯é€‚é…
- âœ… **åŠ è½½çŠ¶æ€**: ä¼˜åŒ–çš„äº¤äº’åé¦ˆ
- âœ… **é€šçŸ¥ç³»ç»Ÿ**: ç”¨æˆ·å‹å¥½çš„çŠ¶æ€æç¤º

## ğŸ—ï¸ æ¶æ„å˜æ›´

### ç›®å½•ç»“æ„
```
Before (React):          After (Next.js):
â”œâ”€â”€ src/                 â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ App.tsx         â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ App.css         â”‚   â”œâ”€â”€ page.tsx
â”‚   â”œâ”€â”€ index.tsx       â”‚   â”œâ”€â”€ globals.css
â”‚   â””â”€â”€ index.css       â”‚   â””â”€â”€ components/
â”œâ”€â”€ public/             â”‚       â””â”€â”€ ErrorBoundary.tsx
â””â”€â”€ package.json        â”œâ”€â”€ public/
                        â”œâ”€â”€ next.config.js
                        â”œâ”€â”€ tsconfig.json
                        â”œâ”€â”€ Dockerfile
                        â”œâ”€â”€ docker-compose.yml
                        â”œâ”€â”€ deploy.sh
                        â””â”€â”€ package.json
```

### é…ç½®æ–‡ä»¶å˜æ›´

#### package.json
- ç§»é™¤: `react-scripts`
- æ·»åŠ : `next`ã€`eslint-config-next`
- æ›´æ–°: scriptsé…ç½®ä¸ºNext.jså‘½ä»¤

#### æ–°å¢é…ç½®æ–‡ä»¶
- `next.config.js`: Next.jsé…ç½®
- `next-env.d.ts`: TypeScriptç¯å¢ƒå£°æ˜
- `tsconfig.json`: TypeScripté…ç½®ä¼˜åŒ–
- `Dockerfile`: å®¹å™¨åŒ–é…ç½®
- `docker-compose.yml`: å®¹å™¨ç¼–æ’
- `deploy.sh`: è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
- `env.example`: ç¯å¢ƒå˜é‡ç¤ºä¾‹

## ğŸ”§ æ ¸å¿ƒä»£ç è¿ç§»

### 1. å¸ƒå±€ç³»ç»Ÿ
```typescript
// Before: public/index.html + src/index.tsx
// After: app/layout.tsx (Server Component)
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="zh-CN">
      <body>
        <ErrorBoundary>
          {children}
        </ErrorBoundary>
      </body>
    </html>
  )
}
```

### 2. ä¸»é¡µé¢ç»„ä»¶
```typescript
// Before: src/App.tsx
// After: app/page.tsx (Client Component)
'use client'
import React, { useState, useEffect, useRef, useCallback } from 'react';
// ... å®Œæ•´åŠŸèƒ½å®ç°
```

### 3. æ ·å¼ç³»ç»Ÿ
```css
/* Before: src/index.css + src/App.css */
/* After: app/globals.css (åˆå¹¶ä¼˜åŒ–) */
/* ä¿æŒæ‰€æœ‰åŸæœ‰æ ·å¼ç‰¹æ€§ */
```

## ğŸš€ éƒ¨ç½²é€‰é¡¹

### 1. å¼€å‘æ¨¡å¼
```bash
npm run dev
# æˆ–ä½¿ç”¨éƒ¨ç½²è„šæœ¬
./deploy.sh  # é€‰æ‹©é€‰é¡¹ 1
```

### 2. ç”Ÿäº§æ„å»º
```bash
npm run build && npm start
# æˆ–ä½¿ç”¨éƒ¨ç½²è„šæœ¬
./deploy.sh  # é€‰æ‹©é€‰é¡¹ 2
```

### 3. Dockeréƒ¨ç½²
```bash
docker build -t chatbot-web-nextjs .
docker run -p 3000:3000 chatbot-web-nextjs
# æˆ–ä½¿ç”¨éƒ¨ç½²è„šæœ¬
./deploy.sh  # é€‰æ‹©é€‰é¡¹ 3
```

### 4. Docker Compose
```bash
docker-compose up -d --build
# æˆ–ä½¿ç”¨éƒ¨ç½²è„šæœ¬
./deploy.sh  # é€‰æ‹©é€‰é¡¹ 4
```

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–

### æ„å»ºä¼˜åŒ–
- **Bundleåˆ†æ**: Next.jsè‡ªåŠ¨ä»£ç åˆ†å‰²
- **é™æ€ç”Ÿæˆ**: é¢„æ¸²æŸ“é™æ€é¡µé¢
- **å›¾ç‰‡ä¼˜åŒ–**: Next.js Imageç»„ä»¶æ”¯æŒ
- **å­—ä½“ä¼˜åŒ–**: Google Fontsè‡ªåŠ¨ä¼˜åŒ–

### è¿è¡Œæ—¶ä¼˜åŒ–
- **å®¢æˆ·ç«¯ç»„ä»¶**: 'use client'æŒ‡ä»¤
- **æœåŠ¡ç«¯ç»„ä»¶**: é»˜è®¤æœåŠ¡ç«¯æ¸²æŸ“
- **Streaming**: React 18å¹¶å‘ç‰¹æ€§
- **ç¼“å­˜**: Next.jså†…ç½®ç¼“å­˜æœºåˆ¶

## ğŸ”’ å®‰å…¨æ”¹è¿›

### å®‰å…¨å¤´éƒ¨
- Content Security Policy
- X-Frame-Options
- X-Content-Type-Options
- Referrer-Policy

### æ•°æ®ä¿æŠ¤
- ç¯å¢ƒå˜é‡éš”ç¦»
- APIå¯†é’¥å®‰å…¨å­˜å‚¨
- HTTPSå¼ºåˆ¶ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

## ğŸ“š ä½¿ç”¨æŒ‡å—

### é…ç½®è®¾ç½®
1. ç‚¹å‡»å·¦ä¸Šè§’"é…ç½®"æŒ‰é’®
2. é€‰æ‹©LLMæä¾›å•†
3. è¾“å…¥API Key
4. è°ƒæ•´æ¨¡å‹å‚æ•°
5. è®¾ç½®ç³»ç»Ÿæç¤ºè¯
6. å¯ç”¨MCPé›†æˆï¼ˆå¯é€‰ï¼‰

### åŠŸèƒ½ä½¿ç”¨
- **å‘é€æ¶ˆæ¯**: è¾“å…¥æ–‡æœ¬ï¼ŒCtrl+Enterå¿«é€Ÿå‘é€
- **åˆ‡æ¢ä¸»é¢˜**: è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿåå¥½
- **å¯¼å‡ºå¯¹è¯**: å·¥å…·æ "å¯¼å‡º"æŒ‰é’®
- **æ¸…ç©ºèŠå¤©**: å·¥å…·æ "æ¸…ç©º"æŒ‰é’®
- **é…ç½®ä¿å­˜**: è‡ªåŠ¨ä¿å­˜åˆ°localStorage

## ğŸ› é—®é¢˜æ’æŸ¥

### å¸¸è§é—®é¢˜
1. **æ„å»ºå¤±è´¥**: æ£€æŸ¥Node.jsç‰ˆæœ¬ï¼ˆéœ€è¦18+ï¼‰
2. **MCPè¿æ¥å¤±è´¥**: ç¡®è®¤æœåŠ¡å™¨åœ°å€å’Œç«¯å£
3. **APIè°ƒç”¨å¤±è´¥**: éªŒè¯API Keyå’Œç½‘ç»œè¿æ¥
4. **æ ·å¼å¼‚å¸¸**: æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

### è°ƒè¯•æ–¹æ³•
```bash
# æ£€æŸ¥æ—¥å¿—
npm run dev  # å¼€å‘æ¨¡å¼æŸ¥çœ‹æ§åˆ¶å°
npm run build  # æ„å»ºæ—¶é”™è¯¯æ£€æŸ¥
npm run lint  # ESLintä»£ç æ£€æŸ¥
```

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚éœ€å›æ»šåˆ°Reactç‰ˆæœ¬ï¼š
1. å¤‡ä»½å½“å‰Next.jsç‰ˆæœ¬
2. æ¢å¤åŸå§‹Reactä»£ç 
3. é‡æ–°å®‰è£…Reactä¾èµ–
4. å¯åŠ¨Reactå¼€å‘æœåŠ¡å™¨

## ğŸ“ˆ åç»­ä¼˜åŒ–

### å¯é€‰æ”¹è¿›
- [ ] PWAæ”¯æŒï¼ˆService Workerï¼‰
- [ ] å›½é™…åŒ–ï¼ˆi18nï¼‰
- [ ] ä¸»é¢˜åˆ‡æ¢å™¨
- [ ] è¯­éŸ³è¾“å…¥/è¾“å‡º
- [ ] æ›´å¤šMCPå·¥å…·é›†æˆ
- [ ] æ€§èƒ½ç›‘æ§é›†æˆ

### æŠ€æœ¯å€ºåŠ¡
- [ ] å•å…ƒæµ‹è¯•è¡¥å……
- [ ] E2Eæµ‹è¯•æ·»åŠ 
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] å®‰å…¨å®¡è®¡

## ğŸ“ æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Node.jsç‰ˆæœ¬å…¼å®¹æ€§
2. ä¾èµ–åŒ…å®Œæ•´æ€§
3. ç¯å¢ƒå˜é‡é…ç½®
4. ç½‘ç»œè¿æ¥çŠ¶æ€

---

**è¿ç§»å®Œæˆæ—¶é—´**: 2024å¹´å½“å‰æ—¥æœŸ  
**Next.jsç‰ˆæœ¬**: 14.2.30  
**Node.jsè¦æ±‚**: 18.0.0+  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª 